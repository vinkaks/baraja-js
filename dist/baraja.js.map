{"version":3,"sources":["../src/baraja.js"],"names":["Baraja","container","options","self","defaults","easing","speed","tapAnimations","Object","assign","setDefaultFanSettings","items","getItemsAsArray","itemTotal","length","isClosed","zIndexMin","setStack","initClickEvents","Error","fanSettings","direction","origin","x","y","range","translation","center","scatter","validateDefaultFanSettings","settings","forEach","item","index","style","zIndex","toString","updateStack","element","stepNext","zIndexCurr","parseInt","update","eventHandler","isAnimating","move2front","addEventListener","resetTransition","transition","setOrigin","transformOrigin","setTransition","property","duration","timingFunc","delay","animation","applyTransition","force","call","setTimeoutFrame","opacity","transform","isTop","callback","close","fan","cssTransform","removeEventListener","add","html","insertAdjacentHTML","oldItemTotal","currItems","slice","newItemCount","Math","abs","newItems","splice","reverse","count","filter","setFanSettings","stepLeft","minX","maxX","max","min","stepOrigin","pos","originX","stepAngle","stepTranslation","val","angle","position","extraAngle","floor","random","extraPosition","navigate","find","rotation","offsetWidth","dispatch","func","args","handler","timeout","start","step","timestamp","progress","window","requestAnimationFrame","elements","querySelectorAll","Array","prototype","last","previous","next","baraja","module","exports"],"mappings":"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","file":"baraja.js","sourcesContent":["/* eslint-disable max-statements */\n/**\n *  BarajaJS\n *  A plugin for spreading items in a card-like fashion.\n *\n *  Copyright 2019, Marc S. Brooks (https://mbrooks.info)\n *  Licensed under the MIT license:\n *  http://www.opensource.org/licenses/mit-license.php\n */\n\n'use strict';\n\n/**\n * @param {HTMLElement} container\n *   Containing HTML element.\n *\n * @param {Object} options\n *   Configuration overrides (optional).\n */\nfunction Baraja(container, options = {}) {\n  const self = this;\n\n  const defaults = {\n    easing: 'ease-in-out',\n    speed:  300,\n    tapAnimations: true\n  };\n\n  (function() {\n    self.options = Object.assign(defaults, options);\n\n    setDefaultFanSettings();\n\n    self.items = getItemsAsArray();\n\n    self.itemTotal = self.items.length;\n\n    if (self.itemTotal > 1) {\n      self.isClosed  = true;\n      self.zIndexMin = 1000;\n\n      setStack();\n\n      initClickEvents();\n    } else {\n      throw new Error('Failed to initialize (no items found)');\n    }\n  })();\n\n  function setDefaultFanSettings() {\n    self.fanSettings = {\n      easing:      'ease-out',\n      direction:   'right',\n      origin:      {x: 25, y: 100},\n      speed:       500,\n      range:       90,\n      translation: 0,\n      center:      true,\n      scatter:     false\n    };\n  }\n\n  /**\n   * Validate default fan settings.\n   *\n   * @param {Object} settings\n   *   Fan settings (optional).\n   */\n  function validateDefaultFanSettings(settings) {\n    settings.direction   = settings.direction   || self.fanSettings.direction;\n    settings.easing      = settings.easing      || self.fanSettings.easing;\n    settings.speed       = settings.speed       || self.fanSettings.speed;\n    settings.range       = settings.range       || self.fanSettings.range;\n    settings.translation = settings.translation || self.fanSettings.translation;\n\n    if (!settings.origin) {\n      settings.origin = self.fanSettings.origin;\n    } else {\n      settings.origin.x = settings.origin.x || self.fanSettings.origin.x;\n      settings.origin.y = settings.origin.y || self.fanSettings.origin.y;\n    }\n\n    if (!settings.center) {\n      settings.center = self.fanSettings.center;\n    }\n\n    if (!settings.scatter) {\n      settings.scatter = self.fanSettings.scatter;\n    }\n\n    self.direction = settings.direction;\n\n    return settings;\n  }\n\n  /**\n   * Set the zIndex for the given items.\n   *\n   * @param {Array} items.\n   *   Array of HTML elements (optional).\n   */\n  function setStack(items = self.items) {\n    items.forEach(function(item, index) {\n      item.style.zIndex = (self.zIndexMin + self.itemTotal - 1 - index)\n        .toString();\n    });\n  }\n\n  /**\n   * Update the zIndex for the given element.\n   *\n   * @param {HTMLElement} element\n   *   HTML element.\n   *\n   * @param {String} direction\n   *   Stack direction (last|next).\n   */\n  function updateStack(element, direction) {\n    const stepNext = (direction === 'next');\n\n    const zIndexCurr = parseInt(element.style.zIndex);\n\n    element.style.zIndex = (stepNext)\n      ? self.zIndexMin - 1\n      : self.zIndexMin + self.itemTotal;\n\n    self.items.forEach(function(item) {\n      const zIndex = parseInt(item.style.zIndex);\n\n      const update = (stepNext)\n        ? (zIndex < zIndexCurr)\n        : (zIndex > zIndexCurr);\n\n      if (update) {\n        item.style.zIndex = (stepNext)\n          ? zIndex + 1\n          : zIndex - 1;\n      }\n    });\n  }\n\n  /**\n   * Initialize element click event handlers.\n   *\n   * @param {Array} items\n   *   Array of HTML elements (optional).\n   */\n  function initClickEvents(items = self.items) {\n    items.forEach(function(item) {\n      const eventHandler = function() {\n        if (!self.isAnimating) {\n          move2front(item);\n        }\n      };\n\n      item.addEventListener('click', eventHandler, true);\n    });\n  }\n\n  /**\n   * Disable the CSS transition for a given element.\n   *\n   * @param {HTMLElement} element\n   *   HTML element.\n   */\n  function resetTransition(element) {\n    element.style.transition = 'none';\n  }\n\n  /**\n   * Set the CSS transform-origin for a given element.\n   *\n   * @param {HTMLElement} element\n   *   HTML element.\n   *\n   * @param {Number} x\n   *   Horizontal axis.\n   *\n   * @param {Number} y\n   *   Vertical axis.\n   */\n  function setOrigin(element, x, y) {\n    element.style.transformOrigin = `${x}% ${y}%`;\n  }\n\n  /**\n   * Set the CSS transition for a given element.\n   *\n   * @param {HTMLElement} element\n   *   HTML element.\n   *\n   * @param {String} property\n   *   Property (optional).\n   *\n   * @param {String} duration\n   *   Duration (optional).\n   *\n   * @param {String} timingFunc\n   *   Timing-function (optional).\n   *\n   * @param {Number} delay\n   *   Delay (optional).\n   */\n  function setTransition(element,\n    property   = 'all',\n    duration   = self.options.speed,\n    timingFunc = self.options.easing,\n    delay      = 0) {\n\n    const animation = `${duration}ms ${timingFunc} ${delay}ms`;\n\n    element.style.transition = (property === 'transform')\n      ? `transform ${animation}`\n      : `${property} ${animation}`;\n  }\n\n  /**\n   * Apply the CSS transform for a given element.\n   *\n   * @param {HTMLElement} element\n   *   HTML element.\n   *\n   * @param {String} easing\n   *   Transform-function.\n   *\n   * @param {Function} eventHandler\n   *   Listener event handler.\n   *\n   * @param {Boolean} force\n   *   Force listener event (optional).\n   */\n  function applyTransition(element, easing, eventHandler, force = false) {\n    if (eventHandler) {\n      element.addEventListener('transitionend', eventHandler, false);\n\n      if (force) {\n        eventHandler.call();\n      }\n    }\n\n    setTimeoutFrame(function() {\n      if (easing === 'none') {\n        element.style.opacity = '1';\n      }\n\n      element.style.transform = easing;\n    }, 25);\n  }\n\n  /**\n   * Relocate the element on top of the stack.\n   *\n   * @param {HTMLElement} element\n   *   HTML element.\n   */\n  function move2front(element) {\n    self.isAnimating = true;\n\n    const zIndexCurr = parseInt(element.style.zIndex);\n\n    const isTop = (zIndexCurr === self.zIndexMin + self.itemTotal - 1);\n\n    const callback = (isTop)\n      ? function() {\n          self.isAnimating = false;\n        }\n      : function() {\n          return false;\n        };\n\n    element = (isTop)\n      ? null\n      : element;\n\n    if (!self.isClosed) {\n      close(callback, element);\n    } else {\n      if (self.options.tapAnimations){\n        fan();\n      }\n    }\n    if (isTop) {\n      return;\n    }\n\n    resetTransition(element);\n\n    setOrigin(element, 50, 50);\n\n    element.style.opacity   = '0';\n    element.style.transform = 'scale(2) translate(100px) rotate(20deg)';\n\n    updateStack(element, 'last');\n\n    setTimeoutFrame(function() {\n      setTransition(element, 'all', self.options.speed, 'ease-in');\n\n      const cssTransform = 'none';\n\n      const eventHandler = function() {\n        element.removeEventListener('transitionend', eventHandler);\n\n        self.isAnimating = false;\n      };\n\n      applyTransition(element, cssTransform, eventHandler);\n    }, self.options.speed / 2);\n  }\n\n  /**\n   * Add items to the HTMLElement container.\n   *\n   * @param {String} html\n   *   HTML elements as text.\n   */\n  function add(html) {\n    container.insertAdjacentHTML('beforeend', html);\n\n    const oldItemTotal = self.itemTotal;\n\n    const currItems = getItemsAsArray();\n\n    self.items     = currItems.slice();\n    self.itemTotal = currItems.length;\n\n    const newItemCount = Math.abs(self.itemTotal - oldItemTotal);\n\n    let newItems = currItems.splice(oldItemTotal, newItemCount);\n\n    newItems.forEach(function(item) {\n      item.style.opacity = '0';\n    });\n\n    initClickEvents(newItems);\n\n    setStack(newItems);\n\n    newItems = newItems.reverse();\n\n    let count = 0;\n\n    newItems.forEach(function(item, index) {\n      item.style.transform = 'scale(1.8) translate(200px) rotate(15deg)';\n\n      setTransition(item, 'all', '500', 'ease-out', index * 200);\n\n      const cssTransform = 'none';\n\n      const eventHandler = function() {\n        ++count;\n\n        item.removeEventListener('transitionend', eventHandler);\n\n        resetTransition(item);\n\n        if (count === newItemCount) {\n          self.isAnimating = false;\n        }\n      };\n\n      applyTransition(item, cssTransform, eventHandler);\n    });\n  }\n\n  /**\n   * Close the spread fan.\n   *\n   * @param {Function} callback\n   *   Callback function (optional).\n   *\n   * @param {HTMLElement} element\n   *   HTML element (optional).\n   */\n  function close(callback = null, element = null) {\n    let items = self.items;\n\n    if (element) {\n      items = items.filter(function(item) {\n        return (item !== element);\n      });\n    }\n\n    const force = (self.isClosed);\n\n    const cssTransform = 'none';\n\n    items.forEach(function(item) {\n      const eventHandler = function() {\n        self.isClosed = true;\n\n        item.removeEventListener('transitionend', eventHandler);\n\n        resetTransition(item);\n\n        setTimeoutFrame(function() {\n          setOrigin(item, 50, 50);\n\n          if (callback) {\n            callback.call();\n          }\n        }, 25);\n      };\n\n      applyTransition(item, cssTransform, eventHandler, force);\n    });\n  }\n\n  function setFanSettings(settings = {}){\n    self.fanSettings = validateDefaultFanSettings(settings);\n  }\n\n  /**\n   * Spread the stack based on defined settings.\n   *\n   * @param {Object} settings\n   *   Fan settings (optional).\n   */\n  function fan(settings = {}) {\n    self.isClosed = false;\n\n    settings = validateDefaultFanSettings(settings);\n\n    const stepLeft = (settings.direction === 'left');\n\n    if (settings.origin.minX && settings.origin.maxX) {\n      const max = settings.origin.maxX;\n      const min = settings.origin.minX;\n\n      const stepOrigin = (max - min) / self.itemTotal;\n\n      self.items.forEach(function(item) {\n        const zIndexCurr = parseInt(item.style.zIndex);\n\n        const pos = self.itemTotal - 1 - (zIndexCurr - self.zIndexMin);\n\n        let originX = pos * (max - min + stepOrigin) / self.itemTotal + min;\n\n        if (stepLeft) {\n          originX = max + min - originX;\n        }\n\n        setOrigin(item, originX, settings.origin.y);\n      });\n    } else {\n      self.items.forEach(function(item) {\n        setOrigin(item, settings.origin.x , settings.origin.y);\n      });\n    }\n\n    const stepAngle = settings.range / (self.itemTotal - 1);\n\n    const stepTranslation = settings.translation / (self.itemTotal - 1);\n\n    let count = 0;\n\n    self.items.forEach(function(item) {\n      setTransition(item, 'transform');\n\n      const zIndexCurr = parseInt(item.style.zIndex);\n\n      const pos = self.itemTotal - 1 - (zIndexCurr - self.zIndexMin);\n\n      const val = (settings.center)\n        ? settings.range / 2\n        : settings.range;\n\n      let angle = val - stepAngle * pos;\n\n      let position = stepTranslation * (self.itemTotal - pos - 1);\n\n      if (stepLeft) {\n        angle    *= -1;\n        position *= -1;\n      }\n\n      if (settings.scatter) {\n        const extraAngle    = Math.floor(Math.random() * stepAngle);\n        const extraPosition = Math.floor(Math.random() * stepTranslation);\n\n        if (pos !== self.itemTotal - 1) {\n          if (stepLeft) {\n            angle    = angle + extraAngle;\n            position = position - extraPosition;\n          } else {\n            angle    = angle - extraAngle;\n            position = position + extraPosition;\n          }\n        }\n      }\n\n      const cssTransform = `translate(${position}px) rotate(${angle}deg)`;\n\n      const eventHandler = function() {\n        ++count;\n\n        item.removeEventListener('transitionend', eventHandler);\n\n        if (count === self.itemTotal - 1) {\n          self.isAnimating = false;\n        }\n      };\n\n      applyTransition(item, cssTransform, eventHandler);\n    });\n  }\n\n  /**\n   * Show the last/next item in the stack.\n   *\n   * @param {String} direction\n   *   Stack direction (last|next).\n   */\n  function navigate(direction) {\n    self.isClosed = false;\n\n    const stepNext = (direction === 'next');\n\n    const zIndexCurr = (stepNext)\n      ? self.zIndexMin + self.itemTotal - 1\n      : self.zIndexMin;\n\n    const element = self.items.find(function(item) {\n      return (parseInt(item.style.zIndex) === zIndexCurr);\n    });\n\n    let rotation, translation;\n\n    if (stepNext) {\n      rotation = 5;\n      translation = element.offsetWidth + 15;\n    } else {\n      rotation = 5 * -1;\n      translation = element.offsetWidth * -1 - 15;\n    }\n\n    setTransition(element, 'transform');\n\n    let cssTransform = `translate(${translation}px) rotate(${rotation}deg)`;\n\n    let eventHandler = function() {\n      element.removeEventListener('transitionend', eventHandler);\n\n      updateStack(element, direction);\n\n      cssTransform = 'translate(0px) rotate(0deg)';\n\n      eventHandler = function() {\n        element.removeEventListener('transitionend', eventHandler);\n\n        self.isAnimating = false;\n        self.isClosed    = true;\n      };\n\n      applyTransition(element, cssTransform, eventHandler);\n    };\n\n    applyTransition(element, cssTransform, eventHandler);\n  }\n\n  /**\n   * Dispatch the fan spread action.\n   *\n   * @param {Function} func\n   *   Function to execute.\n   *\n   * @param {*} args\n   *   Function arguments.\n   */\n  function dispatch(func, args) {\n    if (self.itemTotal > 1 || !self.isAnimating) {\n      self.isAnimating = true;\n\n      if (!self.isClosed) {\n        close(function() {\n          func.call(self, args);\n        });\n      } else {\n        func.call(self, args);\n      }\n    }\n  }\n\n  /**\n   * setTimeout alternative for handling animations.\n   *\n   * @param {Function} handler\n   *   Animation handler.\n   *\n   * @param {Number} timeout\n   *   Timeout in milliseconds (optional).\n   */\n  function setTimeoutFrame(handler, timeout = 5000) {\n    let start = 0;\n\n    const step = function(timestamp) {\n      if (!start) {\n        start = timestamp;\n      }\n\n      let progress = timestamp - start;\n      if (progress < timeout) {\n        window.requestAnimationFrame(step);\n      } else {\n        handler();\n      }\n    };\n\n    window.requestAnimationFrame(step);\n  }\n\n  /**\n   * Return HTMLElement container items as array.\n   *\n   * @return {Array}\n   */\n  function getItemsAsArray() {\n    const elements = container.querySelectorAll('li');\n    if (elements) {\n      return Array.prototype.slice.call(elements);\n    }\n  }\n\n  /**\n   * Protected members.\n   */\n  this.add = function(html) {\n    dispatch(add, html);\n  };\n\n  this.fan = function(settings) {\n    dispatch(fan, settings);\n  };\n\n  // Deprecated previous() method (use last)\n  this.last = this.previous = function() {\n    dispatch(navigate, 'last');\n  };\n\n  this.next = function() {\n    dispatch(navigate, 'next');\n  };\n\n  this.close = function() {\n    if (!self.isAnimating) {\n      close();\n    }\n  };\n\n  this.setFanSettings = (settings)=>{\n    dispatch(setFanSettings,settings);\n  };\n}\n\n/**\n * Set global/exportable instance, where supported.\n */\nwindow.baraja = function(container, options) {\n  return new Baraja(container, options);\n};\n\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = Baraja;\n}\n"]}