"use strict";function Baraja(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},g=this,t={easing:"ease-in-out",speed:300,tapAnimations:!0};function i(n){return n.direction=n.direction||g.fanSettings.direction,n.easing=n.easing||g.fanSettings.easing,n.speed=n.speed||g.fanSettings.speed,n.range=n.range||g.fanSettings.range,n.translation=n.translation||g.fanSettings.translation,n.origin?(n.origin.x=n.origin.x||g.fanSettings.origin.x,n.origin.y=n.origin.y||g.fanSettings.origin.y):n.origin=g.fanSettings.origin,n.center||(n.center=g.fanSettings.center),n.scatter||(n.scatter=g.fanSettings.scatter),g.direction=n.direction,n}function s(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:g.items).forEach(function(n,t){n.style.zIndex=(g.zIndexMin+g.itemTotal-1-t).toString()})}function l(n,t){var i="next"===t,e=parseInt(n.style.zIndex);n.style.zIndex=i?g.zIndexMin-1:g.zIndexMin+g.itemTotal,g.items.forEach(function(n){var t=parseInt(n.style.zIndex);(i?t<e:e<t)&&(n.style.zIndex=i?t+1:t-1)})}function f(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:g.items).forEach(function(n){n.addEventListener("click",function(){g.isAnimating||function(t){g.isAnimating=!0;var n=parseInt(t.style.zIndex)===g.zIndexMin+g.itemTotal-1,i=n?function(){g.isAnimating=!1}:function(){return!1};t=n?null:t,g.isClosed?g.options.tapAnimations&&d():o(i,t),n||(c(t),u(t,50,50),t.style.opacity="0",t.style.transform="scale(2) translate(100px) rotate(20deg)",l(t,"last"),x(function(){m(t,"all",g.options.speed,"ease-in"),v(t,"none",function n(){t.removeEventListener("transitionend",n),g.isAnimating=!1})},g.options.speed/2))}(n)},!0)})}function c(n){n.style.transition="none"}function u(n,t,i){n.style.transformOrigin=t+"% "+i+"%"}function m(n){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"all",i=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:g.options.speed)+"ms "+(3<arguments.length&&void 0!==arguments[3]?arguments[3]:g.options.easing)+" "+(4<arguments.length&&void 0!==arguments[4]?arguments[4]:0)+"ms";n.style.transition="transform"===t?"transform "+i:t+" "+i}function v(n,t,i){var e=3<arguments.length&&void 0!==arguments[3]&&arguments[3];i&&(n.addEventListener("transitionend",i,!1),e&&i.call()),x(function(){"none"===t&&(n.style.opacity="1"),n.style.transform=t},25)}function e(n){r.insertAdjacentHTML("beforeend",n);var t=g.itemTotal,i=y();g.items=i.slice(),g.itemTotal=i.length;var e=Math.abs(g.itemTotal-t),o=i.splice(t,e);o.forEach(function(n){n.style.opacity="0"}),f(o),s(o),o=o.reverse();var a=0;o.forEach(function(t,n){t.style.transform="scale(1.8) translate(200px) rotate(15deg)",m(t,"all","500","ease-out",200*n);v(t,"none",function n(){++a,t.removeEventListener("transitionend",n),c(t),a===e&&(g.isAnimating=!1)})})}function o(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=g.items;t&&(n=n.filter(function(n){return n!==t}));var e=g.isClosed;n.forEach(function(t){v(t,"none",function n(){g.isClosed=!0,t.removeEventListener("transitionend",n),c(t),x(function(){u(t,50,50),i&&i.call()},25)},e)})}function a(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};g.fanSettings=i(n)}function d(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};g.isClosed=!1;var l="left"===(s=i(s)).direction;if(s.origin.minX&&s.origin.maxX){var e=s.origin.maxX,o=s.origin.minX,a=(e-o)/g.itemTotal;g.items.forEach(function(n){var t=parseInt(n.style.zIndex),i=(g.itemTotal-1-(t-g.zIndexMin))*(e-o+a)/g.itemTotal+o;l&&(i=e+o-i),u(n,i,s.origin.y)})}else g.items.forEach(function(n){u(n,s.origin.x,s.origin.y)});var f=s.range/(g.itemTotal-1),c=s.translation/(g.itemTotal-1),d=0;g.items.forEach(function(t){m(t,"transform");var n=parseInt(t.style.zIndex),i=g.itemTotal-1-(n-g.zIndexMin),e=(s.center?s.range/2:s.range)-f*i,o=c*(g.itemTotal-i-1);if(l&&(e*=-1,o*=-1),s.scatter){var a=Math.floor(Math.random()*f),r=Math.floor(Math.random()*c);i!==g.itemTotal-1&&(l?(e+=a,o-=r):(e-=a,o+=r))}v(t,"translate("+o+"px) rotate("+e+"deg)",function n(){++d,t.removeEventListener("transitionend",n),d===g.itemTotal-1&&(g.isAnimating=!1)})})}function h(n){g.isClosed=!1;var t="next"===n,i=t?g.zIndexMin+g.itemTotal-1:g.zIndexMin,e=g.items.find(function(n){return parseInt(n.style.zIndex)===i}),o=void 0,a=void 0;a=t?(o=5,e.offsetWidth+15):(o=-5,-1*e.offsetWidth-15),m(e,"transform");var r="translate("+a+"px) rotate("+o+"deg)",s=function(){e.removeEventListener("transitionend",s),l(e,n),v(e,r="translate(0px) rotate(0deg)",s=function(){e.removeEventListener("transitionend",s),g.isAnimating=!1,g.isClosed=!0})};v(e,r,s)}function p(n,t){(1<g.itemTotal||!g.isAnimating)&&(g.isAnimating=!0,g.isClosed?n.call(g,t):o(function(){n.call(g,t)}))}function x(i){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5e3,o=0;window.requestAnimationFrame(function n(t){o||(o=t),t-o<e?window.requestAnimationFrame(n):i()})}function y(){var n=r.querySelectorAll("li");if(n)return Array.prototype.slice.call(n)}!function(){if(g.options=Object.assign(t,n),g.fanSettings={easing:"ease-out",direction:"right",origin:{x:25,y:100},speed:500,range:90,translation:0,center:!0,scatter:!1},g.items=y(),g.itemTotal=g.items.length,!(1<g.itemTotal))throw new Error("Failed to initialize (no items found)");g.isClosed=!0,g.zIndexMin=1e3,s(),f()}(),this.add=function(n){p(e,n)},this.fan=function(n){p(d,n)},this.last=this.previous=function(){p(h,"last")},this.next=function(){p(h,"next")},this.close=function(){g.isAnimating||o()},this.setFanSettings=function(n){p(a,n)}}window.baraja=function(n,t){return new Baraja(n,t)},"undefined"!=typeof module&&module.exports&&(module.exports=Baraja);